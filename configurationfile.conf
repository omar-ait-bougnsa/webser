
server {
    listen      8080 default_server;
    server_name _; 
    
    client_max_body_size 1M;
    
    error_page 500 502 503 504 /50x.html;

    error_page 403 /errors/500.html;
    
    # Root route - serves static files
    location / 
    {
        root      /var/www/default;
        index     index.html a.html b.html;
        autoindex off;
        methods   GET;  # Only allow GET requests
    }
}

# MAIN WEBSITE (example.com)
server {
    listen      8080;
    server_name example.com www.example.com;
    
    client_max_body_size 10M;  # Larger limit for uploads
    
    # Custom error pages
    error_page 404 /custom_404.html;
    error_page 500 /custom_500.html;
    
    # API ROUTE - JSON endpoints
    location /api 
    {
        root      /var/www/api;
        index     api.json;
        methods   GET POST;
        autoindex off;
    }
    
    # UPLOAD ROUTE - File upload handling
    location /uploads 
    {
        root          /var/www/uploads;
        methods       GET POST DELETE;
        autoindex     on;          # Show directory listings
        upload_store  /tmp/uploads; # Temporary storage
        upload_limit  50M;         # Per-route size limit
    }
    
    # REDIRECT EXAMPLE - Old to new location
    location /old 
    {
        redirect /new 301;  # Permanent redirect
    }
    
    # CGI ROUTE - Execute scripts
    location /cgi-bin 
    {
        root      /var/www/cgi;
        methods   GET POST;
        cgi       .py .php;                     # Extensions to handle
        cgi_path  /usr/bin/python3 /usr/bin/php; # Interpreters
    }
    
    # STATIC FILES - With directory index
    location /static 
    {
        root      /var/www/static;
        index     index.html;
        methods   GET;
        autoindex on;  # Allow directory listings
    }
}
